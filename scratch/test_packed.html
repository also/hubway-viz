<script>
var xhr = new XMLHttpRequest();
xhr.open('GET', '/output/trips_packed', true);
xhr.responseType = 'arraybuffer';

xhr.onload = function(e) {
  if (this.status == 200) {
    var d = e.target.response;
    var data = new Int32Array(d);
    var records = 0;
    var start_time = new Date;
    for (var i = 0, len = data.length; i < len; i+= 2) {
      records++;
      var a = data[i];
      var b = data[i + 1];
      var user_index = a & 0x7ff;
      a >>>= 11;
      bike_index = a & 0x3ff;
      a >>>= 10;
      end_station = a & 0x7f;
      a >>>= 7;
      start_station = (a | (b << 4)) & 0x7f;
      b >>>= 3;
      duration = b & 0x1fff;
      b >>>= 13;
      start_date_error = b;
      //console.log(start_date_error, duration, start_station, end_station, bike_index, user_index);
    }
    var end_time = new Date;
    console.log('done ' + records + ' in ' + (end_time - start_time));
  }
};

xhr.send();
</script>
